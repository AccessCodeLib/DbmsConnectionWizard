<!DOCTYPE html>

<html><head><meta http-equiv="Content-Type" content="text/html; charset=UTF-8" /><meta http-equiv="X-UA-Compatible" content="IE=edge"><title>SqlTools.cls</title><link rel="stylesheet" type="text/css" href="../styles/main.css" /><script type="text/javascript" src="../styles/main.js"></script><script type="text/javascript">NDLoader.LoadJS("Content", "../styles/");</script></head>

<!-- Generated by Natural Docs, version 2.2 -->

<!-- saved from url=(0016)http://localhost -->

<body onload="NDLoader.OnLoad('Content');" class="NDPage NDContentPage">

<a name="data.SqlTools"></a><a name="Topic11"></a><div class="CTopic TClass LVisualBasic first">
 <div class="CTitle"><span class="Qualifier">data.</span>&#8203;SqlTools</div>
 <div class="CBody"><p>Functions to build sql strings</p><div class="CHeading">Author</div><p>Josef Poetzl</p><div class="CHeading">Remarks</div><p>&quot;Attribute VB_PredeclaredId = True&quot; to enable using SqlTools without explicit instantiation.</p><div class="CHeading">Warning</div><pre class="CText">Don't forget to set parameters for date format, boolean and wildcard for the DBMS.</pre></div>
</div>

<a name="data.SqlTools.Properties"></a><a name="Topic101"></a><div class="CTopic TGroup LVisualBasic">
 <div class="CTitle">Properties</div>
</div>

<a name="data.SqlTools.SqlWildCardString"></a><a name="Topic102"></a><div class="CTopic TProperty LVisualBasic">
 <div class="CTitle">SqlWildCardString</div>
 <div class="CBody"><p>Wildcard character for like</p></div>
</div>

<a name="data.SqlTools.SqlDateFormat"></a><a name="Topic125"></a><div class="CTopic TProperty LVisualBasic">
 <div class="CTitle">SqlDateFormat</div>
 <div class="CBody"><p>Format for date values</p></div>
</div>

<a name="data.SqlTools.SqlBooleanTrueString"></a><a name="Topic126"></a><div class="CTopic TProperty LVisualBasic">
 <div class="CTitle">SqlBooleanTrueString</div>
 <div class="CBody"><p>Boolean string in SQL statement</p></div>
</div>

<a name="data.SqlTools.Functions"></a><a name="Topic127"></a><div class="CTopic TGroup LVisualBasic">
 <div class="CTitle">Functions</div>
</div>

<a name="data.SqlTools.Clone"></a><a name="Topic128"></a><div class="CTopic TFunction LVisualBasic">
 <div class="CTitle">Clone</div>
 <div id="NDPrototype128" class="NDPrototype WideForm"><div class="PSection PParameterSection CStyle"><table><tr><td class="PBeforeParameters">Public Function Clone(</td><td class="PParametersParentCell"><table class="PParameters"><tr><td class="PModifierQualifier first">Optional ByVal NewSqlDateFormat&nbsp;</td><td class="PType">As&nbsp;</td><td class="PName">String</td><td class="PDefaultValueSeparator">&nbsp;=&nbsp;</td><td class="PDefaultValue last">SQL_DEFAULT_DATEFORMAT,</td></tr><tr><td class="PModifierQualifier first">Optional ByVal NewSqlBooleanTrueString&nbsp;</td><td class="PType">As&nbsp;</td><td class="PName">String</td><td class="PDefaultValueSeparator">&nbsp;=&nbsp;</td><td class="PDefaultValue last">SQL_DEFAULT_BOOLTRUESTRING,</td></tr><tr><td class="PModifierQualifier first">Optional ByVal NewSqlWildCardString&nbsp;</td><td class="PType">As&nbsp;</td><td class="PName">String</td><td class="PDefaultValueSeparator">&nbsp;=&nbsp;</td><td class="PDefaultValue last">SQL_DEFAULT_WILDCARD</td></tr></table></td><td class="PAfterParameters">) As SqlTools</td></tr></table></div></div>
 <div class="CBody"><p>Create a new instance with basic settings of the current instance.</p><div class="CHeading">Parameters</div><table class="CDefinitionList"><tr><td class="CDLEntry">NewSqlDateFormat</td><td class="CDLDefinition"><p>use this date format instead of base instance</p></td></tr><tr><td class="CDLEntry">NewSqlBooleanTrueString</td><td class="CDLDefinition"><p>use this text for true instead of base instance</p></td></tr><tr><td class="CDLEntry">NewSqlWildCardString</td><td class="CDLDefinition"><p>use this wildcard string instead of base instance</p></td></tr></table><div class="CHeading">Returns</div><p>SqlTools instance with config form base</p><div class="CHeading">See Also</div><p>NewInstance</p></div>
</div>

<a name="data.SqlTools.NewInstance"></a><a name="Topic129"></a><div class="CTopic TFunction LVisualBasic">
 <div class="CTitle">NewInstance</div>
 <div id="NDPrototype129" class="NDPrototype WideForm"><div class="PSection PParameterSection CStyle"><table><tr><td class="PBeforeParameters">Public Function NewInstance(</td><td class="PParametersParentCell"><table class="PParameters"><tr><td class="PModifierQualifier first">ByVal NewSqlDateFormat&nbsp;</td><td class="PType">As&nbsp;</td><td class="PName last">String,</td></tr><tr><td class="PModifierQualifier first">ByVal NewSqlBooleanTrueString&nbsp;</td><td class="PType">As&nbsp;</td><td class="PName last">String,</td></tr><tr><td class="PModifierQualifier first">ByVal NewSqlWildCardString&nbsp;</td><td class="PType">As&nbsp;</td><td class="PName last">String</td></tr></table></td><td class="PAfterParameters">) As SqlTools</td></tr></table></div></div>
 <div class="CBody"><p>Create a new instance</p></div>
</div>

<a name="data.SqlTools.BuildCriteria"></a><a name="Topic13"></a><div class="CTopic TFunction LVisualBasic">
 <div class="CTitle">BuildCriteria</div>
 <div id="NDPrototype13" class="NDPrototype WideForm"><div class="PSection PParameterSection CStyle"><table><tr><td class="PBeforeParameters">Public Function BuildCriteria(</td><td class="PParametersParentCell"><table class="PParameters"><tr><td class="PModifierQualifier first">ByVal FieldName&nbsp;</td><td class="PType">As&nbsp;</td><td class="PName">String,</td><td></td><td class="last"></td></tr><tr><td class="PModifierQualifier first">ByVal FieldDataType&nbsp;</td><td class="PType">As&nbsp;</td><td class="PName">SqlFieldDataType,</td><td></td><td class="last"></td></tr><tr><td class="PModifierQualifier first">ByVal RelationalOperator&nbsp;</td><td class="PType">As&nbsp;</td><td class="PName">SqlRelationalOperators,</td><td></td><td class="last"></td></tr><tr><td class="PModifierQualifier first">ByVal FilterValue&nbsp;</td><td class="PType">As&nbsp;</td><td class="PName">Variant,</td><td></td><td class="last"></td></tr><tr><td class="PModifierQualifier first">Optional ByVal FilterValue2&nbsp;</td><td class="PType">As&nbsp;</td><td class="PName">Variant</td><td class="PDefaultValueSeparator">&nbsp;=&nbsp;</td><td class="PDefaultValue last">Null,</td></tr><tr><td class="PModifierQualifier first">Optional ByVal IgnoreValue&nbsp;</td><td class="PType">As&nbsp;</td><td class="PName">Variant,</td><td></td><td class="last"></td></tr><tr><td class="PModifierQualifier first">Optional ByVal DisableIgnoreNullValue&nbsp;</td><td class="PType">As&nbsp;</td><td class="PName">Boolean</td><td class="PDefaultValueSeparator">&nbsp;=&nbsp;</td><td class="PDefaultValue last">False</td></tr></table></td><td class="PAfterParameters">) As String</td></tr></table></div></div>
 <div class="CBody"><p>Create SQL criteria string</p><div class="CHeading">Parameters</div><table class="CDefinitionList"><tr><td class="CDLEntry">FieldName</td><td class="CDLDefinition"><p>Field name in the data source to be filtered</p></td></tr><tr><td class="CDLEntry">RelationalOperator</td><td class="CDLDefinition"><p>Relational operator (=, &lt;=, etc.)</p></td></tr><tr><td class="CDLEntry">FilterValue</td><td class="CDLDefinition"><p>Filter value (can be a single value or an array of values)</p></td></tr><tr><td class="CDLEntry">FilterValue2</td><td class="CDLDefinition"><p>Optional 2nd filter value (for Between)</p></td></tr><tr><td class="CDLEntry">IgnoreValue</td><td class="CDLDefinition"><p>The value for which no filter condition is to be created. (Array transfer of values possible)</p></td></tr></table><div class="CHeading">Returns</div><p>SQL criteria string</p></div>
</div>

<a name="data.SqlTools.ConvertToSqlText"></a><a name="Topic131"></a><div class="CTopic TFunction LVisualBasic">
 <div class="CTitle">ConvertToSqlText</div>
 <div id="NDPrototype131" class="NDPrototype WideForm"><div class="PSection PParameterSection CStyle"><table><tr><td class="PBeforeParameters">Public Function ConvertToSqlText(</td><td class="PParametersParentCell"><table class="PParameters"><tr><td class="PModifierQualifier first">ByVal Value&nbsp;</td><td class="PType">As&nbsp;</td><td class="PName last">Variant,</td></tr><tr><td class="PModifierQualifier first">ByVal FieldDataType&nbsp;</td><td class="PType">As&nbsp;</td><td class="PName last">SqlFieldDataType</td></tr></table></td><td class="PAfterParameters">) As String</td></tr></table></div></div>
 <div class="CBody"><p>/** &lt;summary&gt; Convert values to string for SQL statement assembled by VBA.&nbsp; &lt;/summary&gt; &lt;param name=&quot;Value&quot;&gt;Value to convert&lt;/param&gt; &lt;param name=&quot;FieldDataType&quot;&gt;Data type of the value to be converted&lt;/param&gt; &lt;returns&gt;String&lt;/returns&gt; **/</p></div>
</div>

<a name="data.SqlTools.TextToSqlText"></a><a name="Topic132"></a><div class="CTopic TFunction LVisualBasic">
 <div class="CTitle">TextToSqlText</div>
 <div id="NDPrototype132" class="NDPrototype WideForm"><div class="PSection PParameterSection CStyle"><table><tr><td class="PBeforeParameters">Public Function TextToSqlText(</td><td class="PParametersParentCell"><table class="PParameters"><tr><td class="PModifierQualifier first">ByVal Value&nbsp;</td><td class="PType">As&nbsp;</td><td class="PName">Variant,</td><td></td><td class="last"></td></tr><tr><td class="PModifierQualifier first">Optional ByVal Delimiter&nbsp;</td><td class="PType">As&nbsp;</td><td class="PName">String</td><td class="PDefaultValueSeparator">&nbsp;=&nbsp;</td><td class="PDefaultValue last">SQL_DEFAULT_TEXTDELIMITER,</td></tr><tr><td class="PModifierQualifier first">Optional ByVal WithoutLeftRightDelim&nbsp;</td><td class="PType">As&nbsp;</td><td class="PName">Boolean</td><td class="PDefaultValueSeparator">&nbsp;=&nbsp;</td><td class="PDefaultValue last">False</td></tr></table></td><td class="PAfterParameters">) As String</td></tr></table></div></div>
 <div class="CBody"><p>/** &lt;summary&gt; Prepare text for SQL statement &lt;/summary&gt; &lt;param name=&quot;Value&quot;&gt;Value to convert&lt;/param&gt; &lt;param name=&quot;Delimiter&quot;&gt;Delimiter for text values. (In most DBMS ' is used as a delimiter).&lt;/param&gt; &lt;param name=&quot;WithoutLeftRightDelim&quot;&gt;Only double the boundary drawing within the values, but do not set the boundary.&lt;/param&gt; &lt;returns&gt;String&lt;/returns&gt; &lt;remarks&gt; Example:&nbsp; strSQL = &quot;select ... from tabelle where Feld = &quot; &amp; TextToSqlText(&quot;ab'cd&quot;) =&gt; strSQL = &quot;select ... from tabelle where Feld = 'ab''cd'&quot; &lt;/remarks&gt; **/</p></div>
</div>

<a name="data.SqlTools.DateToSqlText"></a><a name="Topic133"></a><div class="CTopic TFunction LVisualBasic">
 <div class="CTitle">DateToSqlText</div>
 <div id="NDPrototype133" class="NDPrototype WideForm"><div class="PSection PParameterSection CStyle"><table><tr><td class="PBeforeParameters">Public Function DateToSqlText(</td><td class="PParametersParentCell"><table class="PParameters"><tr><td class="PModifierQualifier first">ByVal Value&nbsp;</td><td class="PType">As&nbsp;</td><td class="PName">Variant,</td><td></td><td class="last"></td></tr><tr><td class="PModifierQualifier first">Optional ByVal FormatString&nbsp;</td><td class="PType">As&nbsp;</td><td class="PName">String</td><td class="PDefaultValueSeparator">&nbsp;=&nbsp;</td><td class="PDefaultValue last">SQL_DEFAULT_DATEFORMAT</td></tr></table></td><td class="PAfterParameters">) As String</td></tr></table></div></div>
 <div class="CBody"><p>/** &lt;summary&gt; Convert date value to string for SQL statement assembled by VBA.&nbsp; &lt;/summary&gt; &lt;param name=&quot;Value&quot;&gt;Value to convert&lt;/param&gt; &lt;param name=&quot;FormatString&quot;&gt;Date format (depends on DBMS!)&lt;/param&gt; &lt;returns&gt;String&lt;/returns&gt; **/</p></div>
</div>

<a name="data.SqlTools.NumberToSqlText"></a><a name="Topic134"></a><div class="CTopic TFunction LVisualBasic">
 <div class="CTitle">NumberToSqlText</div>
 <div id="NDPrototype134" class="NDPrototype WideForm"><div class="PSection PParameterSection CStyle"><table><tr><td class="PBeforeParameters">Public Function NumberToSqlText(</td><td class="PParametersParentCell"><table class="PParameters"><tr><td class="PModifierQualifier first">ByVal Value&nbsp;</td><td class="PType">As&nbsp;</td><td class="PName last">Variant</td></tr></table></td><td class="PAfterParameters">) As String</td></tr></table></div></div>
 <div class="CBody"><p>/** &lt;summary&gt; Zahl für SQL-Text aufbereiten &lt;/summary&gt; &lt;param name=&quot;Value&quot;&gt;Value to convert&lt;/param&gt; &lt;returns&gt;String&lt;/returns&gt; &lt;remarks&gt; Str function ensures &quot;.&quot;.&nbsp; &lt;/remarks&gt; **/</p></div>
</div>

<a name="data.SqlTools.BooleanToSqlText"></a><a name="Topic135"></a><div class="CTopic TFunction LVisualBasic last">
 <div class="CTitle">BooleanToSqlText</div>
 <div id="NDPrototype135" class="NDPrototype WideForm"><div class="PSection PParameterSection CStyle"><table><tr><td class="PBeforeParameters">Public Function BooleanToSqlText(</td><td class="PParametersParentCell"><table class="PParameters"><tr><td class="PModifierQualifier first">ByVal Value&nbsp;</td><td class="PType">As&nbsp;</td><td class="PName">Variant,</td><td></td><td class="last"></td></tr><tr><td class="PModifierQualifier first">Optional ByVal TrueString&nbsp;</td><td class="PType">As&nbsp;</td><td class="PName">String</td><td class="PDefaultValueSeparator">&nbsp;=&nbsp;</td><td class="PDefaultValue last">SQL_DEFAULT_BOOLTRUESTRING</td></tr></table></td><td class="PAfterParameters">) As String</td></tr></table></div></div>
 <div class="CBody"><p>/** &lt;summary&gt; Prepare Boolean for SQL text &lt;/summary&gt; &lt;param name=&quot;Value&quot;&gt;Value to convert&lt;/param&gt; &lt;param name=&quot;TrueString&quot;&gt;String for true value (optional)&lt;/param&gt; &lt;returns&gt;String&lt;/returns&gt; &lt;remarks&gt; &lt;/remarks&gt; **/</p></div>
</div>

</body></html>