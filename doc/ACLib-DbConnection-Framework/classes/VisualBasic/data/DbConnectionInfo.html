<!DOCTYPE html>

<html><head><meta http-equiv="Content-Type" content="text/html; charset=UTF-8" /><meta http-equiv="X-UA-Compatible" content="IE=edge"><title>DbConnectionInfo</title><link rel="stylesheet" type="text/css" href="../../../styles/main.css" /><script type="text/javascript" src="../../../styles/main.js"></script><script type="text/javascript">NDLoader.LoadJS("Content", "../../../styles/");</script></head>

<!-- Generated by Natural Docs, version 2.2 -->

<!-- saved from url=(0016)http://localhost -->

<body onload="NDLoader.OnLoad('Content');" class="NDPage NDContentPage">

<a name="Topic150"></a><div class="CTopic TClass LVisualBasic first">
 <div class="CTitle"><span class="Qualifier">data.</span>&#8203;DbConnectionInfo</div>
 <div class="CBody"><p>Auxiliary class for setting the connection parameters</p><div class="CHeading">Author</div><p>Josef Poetzl</p><div class="CHeading">Remarks</div><p>Uses table usys_DbmsConnection (create table with DBMS Connection Wizard)</p></div>
</div>

<a name="Events"></a><a name="Topic151"></a><div class="CTopic TGroup LVisualBasic">
 <div class="CTitle">Events</div>
</div>

<a name="DbmsConnectionChanged"></a><a name="Topic152"></a><div class="CTopic TEvent LVisualBasic">
 <div class="CTitle">DbmsConnectionChanged</div>
 <div class="CBody"><p>Event when the connection changes</p><div class="CHeading">Parameters</div><table class="CDefinitionList"><tr><td class="CDLEntry">NewConnectionIdentifier</td><td class="CDLDefinition"><p>new used connection identifier (from table data field CID)</p></td></tr></table><div class="CHeading">Remarks</div><p>Can be useful if displays are updated depending on the connection, etc.</p></div>
</div>

<a name="DbmsConnectionInfoCleared"></a><a name="Topic153"></a><div class="CTopic TEvent LVisualBasic">
 <div class="CTitle">DbmsConnectionInfoCleared</div>
 <div class="CBody"><p>Event raised when the connection parameters have been reset</p></div>
</div>

<a name="DbmsInfoMessage"></a><a name="Topic154"></a><div class="CTopic TEvent LVisualBasic">
 <div class="CTitle">DbmsInfoMessage</div>
 <div class="CBody"><p>Information sharing event</p><div class="CHeading">Parameters</div><table class="CDefinitionList"><tr><td class="CDLEntry">Source</td><td class="CDLDefinition"><p>Source of the message</p></td></tr><tr><td class="CDLEntry">Msg</td><td class="CDLDefinition"><p>Message</p></td></tr><tr><td class="CDLEntry">MsgStyle</td><td class="CDLDefinition"><p>VbMsgBoxStyle</p></td></tr></table><div class="CHeading">Remarks</div><p>Used to pass on info (similar to debug.print)</p></div>
</div>

<a name="PasswordChanged"></a><a name="Topic155"></a><div class="CTopic TEvent LVisualBasic">
 <div class="CTitle">PasswordChanged</div>
 <div class="CBody"><p>Event raised when the password has been changed</p></div>
</div>

<a name="Disposed"></a><a name="Topic156"></a><div class="CTopic TEvent LVisualBasic">
 <div class="CTitle">Disposed</div>
 <div class="CBody"><p>Event raised when disposed</p></div>
</div>

<a name="DBMS_Connection_Parameters"></a><a name="Topic157"></a><div class="CTopic TGroup LVisualBasic">
 <div class="CTitle">DBMS Connection Parameters</div>
</div>

<a name="ConnectionIdentifier"></a><a name="Topic158"></a><div class="CTopic TProperty LVisualBasic">
 <div class="CTitle">ConnectionIdentifier</div>
 <div class="CBody"><table class="CDefinitionList"><tr><td class="CDLEntry">Connection identifier</td><td class="CDLDefinition"><p>value from data field CID</p></td></tr></table></div>
</div>

<a name="DbmsName"></a><a name="Topic159"></a><div class="CTopic TProperty LVisualBasic">
 <div class="CTitle">DbmsName</div>
 <div class="CBody"><p>Name of DBMS (MSJET, MSSQL, MySQL, ORACLE, ODBC)</p></div>
</div>

<a name="DbServer"></a><a name="Topic160"></a><div class="CTopic TProperty LVisualBasic">
 <div class="CTitle">DbServer</div>
 <div class="CBody"><p>Name of Database Server</p><div class="CHeading">Remarks</div><p>Incl. instance of SQL Server &amp; co.</p></div>
</div>

<a name="DbName"></a><a name="Topic161"></a><div class="CTopic TProperty LVisualBasic">
 <div class="CTitle">DbName</div>
 <div class="CBody"><p>Name of Database</p></div>
</div>

<a name="DatabaseFile"></a><a name="Topic162"></a><div class="CTopic TProperty LVisualBasic">
 <div class="CTitle">DatabaseFile</div>
 <div class="CBody"><p>File name incl. path of a file-based backend</p></div>
</div>

<a name="UseLoginForm"></a><a name="Topic163"></a><div class="CTopic TProperty LVisualBasic">
 <div class="CTitle">UseLoginForm</div>
 <div class="CBody"><p>Setting from the connection parameters whether to use the login form when logging in.</p></div>
</div>

<a name="LoginForm"></a><a name="Topic164"></a><div class="CTopic TProperty LVisualBasic">
 <div class="CTitle">LoginForm</div>
 <div class="CBody"><p>Form reference to LoginForm</p></div>
</div>

<a name="DbUser"></a><a name="Topic165"></a><div class="CTopic TProperty LVisualBasic">
 <div class="CTitle">DbUser</div>
 <div class="CBody"><p>Name des Datenbankbenutzers</p><div class="CHeading">Parameters</div><table class="CDefinitionList"><tr><td class="CDLEntry">WithoutServerCheck</td><td class="CDLDefinition"><p>True = Do not check whether connection data has already been read in.</p></td></tr></table></div>
</div>

<a name="DbUserPassword"></a><a name="Topic166"></a><div class="CTopic TProperty LVisualBasic">
 <div class="CTitle">DbUserPassword</div>
 <div class="CBody"><p>Password of the database user</p><div class="CHeading">Remarks</div><p>The password should normally never need to be requested and should only be used for sharing within the class structure.</p></div>
</div>

<a name="SavePassword"></a><a name="Topic167"></a><div class="CTopic TProperty LVisualBasic">
 <div class="CTitle">SavePassword</div>
 <div class="CBody"><p>Setting from the connection parameters whether password should be saved for linked tables</p></div>
</div>

<a name="DBMS_Connection"></a><a name="Topic168"></a><div class="CTopic TGroup LVisualBasic">
 <div class="CTitle">DBMS Connection</div>
</div>

<a name="ConnectionStrings"></a><a name="Topic169"></a><div class="CTopic TProperty LVisualBasic">
 <div class="CTitle">ConnectionStrings</div>
 <div class="CBody"><p>ODBC and OLEDB Connectionstring</p><div class="CHeading">Returns</div><p><a href="../../../index.html#VisualBasicClass:data.defDbConnection:DbmsConnectionStrings" target="_top" onmouseover="NDContentPage.OnLinkMouseOver(event,127);" onmouseout="NDContentPage.OnLinkMouseOut(event);" >data.defDbConnection::DbmsConnectionStrings</a></p><div class="CHeading">Remarks</div><p>This procedure must be extended if other DBMSs (such as Oracle) are to be used.</p></div>
</div>

<a name="OledbConnectionString"></a><a name="Topic170"></a><div class="CTopic TProperty LVisualBasic">
 <div class="CTitle">OledbConnectionString</div>
 <div class="CBody"><p>OledbConnectionString</p><div class="CHeading">Returns</div><p>String</p></div>
</div>

<a name="OdbcConnectionString"></a><a name="Topic171"></a><div class="CTopic TProperty LVisualBasic">
 <div class="CTitle">OdbcConnectionString</div>
 <div class="CBody"><p>OdbcConnectionString</p><div class="CHeading">Parameters</div><table class="CDefinitionList"><tr><td class="CDLEntry">WithoutUserInfo</td><td class="CDLDefinition"><p>False = user ID incl. password is contained in the ODBC connection string, True = without user data</p></td></tr></table><div class="CHeading">Returns</div><p>String</p><div class="CHeading">Remarks</div><p>Setting the parameter WithoutUserInfo is normally not necessary, but can be helpful if the ODBC connection string is required without a password.</p></div>
</div>

<a name="CheckConnection"></a><a name="Topic172"></a><div class="CTopic TFunction LVisualBasic">
 <div class="CTitle">CheckConnection</div>
 <div id="NDPrototype172" class="NDPrototype WideForm"><div class="PSection PParameterSection CStyle"><table><tr><td class="PBeforeParameters">Public Function CheckConnection(</td><td class="PParametersParentCell"><table class="PParameters"><tr><td class="PModifierQualifier first">Optional ByRef ErrMsg&nbsp;</td><td class="PType">As&nbsp;</td><td class="PName">String</td><td class="PDefaultValueSeparator">&nbsp;=&nbsp;</td><td class="PDefaultValue last">vbNullString</td></tr></table></td><td class="PAfterParameters">) As Boolean</td></tr></table></div></div>
 <div class="CBody"><p>Check connection to server and database</p><div class="CHeading">Parameters</div><table class="CDefinitionList"><tr><td class="CDLEntry">ErrMsg</td><td class="CDLDefinition"><p>Error message from ADODB or ODBC connection</p></td></tr></table><div class="CHeading">Returns</div><table class="CDefinitionList"><tr><td class="CDLEntry">Boolean</td><td class="CDLDefinition"><p>True = Ado- and ODBC-connection could be established</p></td></tr></table><div class="CHeading">Remarks</div><p>The first test is to establish the ADO connection.&nbsp; As soon as this is successful, the ODBC connection is tested.</p></div>
</div>

<a name="ClearConnectionInfo"></a><a name="Topic173"></a><div class="CTopic TFunction LVisualBasic">
 <div class="CTitle">ClearConnectionInfo</div>
 <div id="NDPrototype173" class="NDPrototype"><div class="PSection PPlainSection">Public Sub ClearConnectionInfo()</div></div>
 <div class="CBody"><p>Delete set connection parameters</p><div class="CHeading">Remarks</div><p>Requires re-reading from table when connection data is requested.</p></div>
</div>

<a name="ChangeDbUserPassword"></a><a name="Topic174"></a><div class="CTopic TFunction LVisualBasic">
 <div class="CTitle">ChangeDbUserPassword</div>
 <div id="NDPrototype174" class="NDPrototype WideForm"><div class="PSection PParameterSection CStyle"><table><tr><td class="PBeforeParameters">Public Function ChangeDbUserPassword(</td><td class="PParametersParentCell"><table class="PParameters"><tr><td class="PModifierQualifier first">ByVal NewPassword&nbsp;</td><td class="PType">As&nbsp;</td><td class="PName">String,</td><td></td><td class="last"></td></tr><tr><td class="PModifierQualifier first">ByVal OldPassword&nbsp;</td><td class="PType">As&nbsp;</td><td class="PName">String,</td><td></td><td class="last"></td></tr><tr><td class="PModifierQualifier first">Optional ByVal LoginName&nbsp;</td><td class="PType">As&nbsp;</td><td class="PName">String</td><td class="PDefaultValueSeparator">&nbsp;=&nbsp;</td><td class="PDefaultValue last">vbNullString,</td></tr><tr><td class="PModifierQualifier first">Optional ByRef Msg&nbsp;</td><td class="PType">As&nbsp;</td><td class="PName">String</td><td></td><td class="last"></td></tr></table></td><td class="PAfterParameters">) As Boolean</td></tr></table></div></div>
 <div class="CBody"><p>Datenbankpasswort des Benutzers ändern</p><div class="CHeading">Parameters</div><table class="CDefinitionList"><tr><td class="CDLEntry">NewPassword</td><td class="CDLDefinition"><p>New passwort</p></td></tr><tr><td class="CDLEntry">OldPassword</td><td class="CDLDefinition"><p>old passwort</p></td></tr><tr><td class="CDLEntry">LoginName</td><td class="CDLDefinition"><p>Login name (If no login name is passed, the current login name is used).</p></td></tr><tr><td class="CDLEntry">Msg</td><td class="CDLDefinition"><p>ByRef parameter to return an error message if the password could not be changed</p></td></tr></table><div class="CHeading">Returns</div><table class="CDefinitionList"><tr><td class="CDLEntry">Boolean</td><td class="CDLDefinition"><p>True = Password has been changed</p></td></tr></table></div>
</div>

<a name="DMBS_specific"></a><a name="Topic175"></a><div class="CTopic TGroup LVisualBasic">
 <div class="CTitle">DMBS specific</div>
</div>

<a name="PermanentBackendRstSqlText"></a><a name="Topic176"></a><div class="CTopic TProperty LVisualBasic">
 <div class="CTitle">PermanentBackendRstSqlText</div>
 <div class="CBody"><p>Select statement for ODBC recordset connection to maintain connection</p><div class="CHeading">Remarks</div><p>This procedure must be extended if other DBMSs (such as Oracle) are to be used.</p></div>
</div>

<a name="TableListSqlText"></a><a name="Topic177"></a><div class="CTopic TProperty LVisualBasic">
 <div class="CTitle">TableListSqlText</div>
 <div class="CBody"><p>SQL-Anweisung im SQL-Dialtekt des DBMS zur Auflistung der im DBS enthaltenen Tabellen</p><div class="CHeading">Remarks</div><p>This procedure must be extended if further DBMS are to be used.</p></div>
</div>

<a name="ParseTableName"></a><a name="Topic178"></a><div class="CTopic TFunction LVisualBasic">
 <div class="CTitle">ParseTableName</div>
 <div id="NDPrototype178" class="NDPrototype WideForm"><div class="PSection PParameterSection CStyle"><table><tr><td class="PBeforeParameters">Public Function ParseTableName(</td><td class="PParametersParentCell"><table class="PParameters"><tr><td class="PModifierQualifier first">ByVal TableName&nbsp;</td><td class="PType">As&nbsp;</td><td class="PName last">String</td></tr></table></td><td class="PAfterParameters">) As String</td></tr></table></div></div>
 <div class="CBody"><p>Auxiliary procedure for adjusting the table name</p><div class="CHeading">Parameters</div><table class="CDefinitionList"><tr><td class="CDLEntry">TableName</td><td class="CDLDefinition"><p>Table name to parse</p></td></tr></table><div class="CHeading">Returns</div><p>Table name for the specific DBMS</p><div class="CHeading">Remarks</div><p>With some DBMS, the name must be case-sensitive or bracketed with special characters.</p></div>
</div>

<a name="DateFormat"></a><a name="Topic179"></a><div class="CTopic TProperty LVisualBasic">
 <div class="CTitle">DateFormat</div>
 <div class="CBody"><p>DBMS specific date format</p><div class="CHeading">Returns</div><p>Format string</p></div>
</div>

<a name="WildCardString"></a><a name="Topic180"></a><div class="CTopic TProperty LVisualBasic">
 <div class="CTitle">WildCardString</div>
 <div class="CBody"><p>DBMS specific wildcard (like *)</p></div>
</div>

<a name="BooleanTrueString"></a><a name="Topic181"></a><div class="CTopic TProperty LVisualBasic">
 <div class="CTitle">BooleanTrueString</div>
 <div class="CBody"><p>DBMS specific string for true</p></div>
</div>

<a name="LoginFormName"></a><a name="Topic182"></a><div class="CTopic TProperty LVisualBasic">
 <div class="CTitle">LoginFormName</div>
 <div class="CBody"><p>Name of the login form</p><div class="CHeading">Remarks</div><p>Example from ACLib: user/login/LoginForm.frm</p></div>
</div>

<a name="DbmsConfigFormName"></a><a name="Topic183"></a><div class="CTopic TProperty LVisualBasic last">
 <div class="CTitle">DbmsConfigFormName</div>
 <div class="CBody"><p>Name of the DBMS configuration form</p></div>
</div>

</body></html>